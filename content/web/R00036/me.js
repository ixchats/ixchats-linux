"use strict";let page,tab,tempFeature=[];document.body.style.backgroundColor="white",document.body.classList.remove("invisible"),$("#navGroup,#navxatApps").addClass("d-none"),Reset(),initConfig(),readUser(),setUser(),navClickHandlers(),startAnalytics(),setLoggedin(),legacyLinks(),cookieBar(),localize(["chats","buy"]),fetchPromo(),setLogo(),document.addEventListener("DOMContentLoaded",(function(){initStuff(),initToolTip()}));let pickersList=[],Commom=$("#CommonDiv").html();function DoTask(e){switch(e){case"meshow":DoMeShow(e);break;case"melogin":DoMeEditLogin(e);break;default:e="meshow",DoMeShow()}page=e,$(".NavTabs").removeClass("active"),$("#tab"+e).addClass("active")}function DoMeShow(){Reset(),$("#meshow").removeClass("d-none"),$("#avaShow").attr("src",xConfig.avatar),$("#userShow").html(xConfig.username),$("#idShow").html(xConfig.id)}function DoMeEditLogin(){Reset(),$("#melogin").removeClass("d-none"),$("#mePassword").focus();getGET();let e="https://rxat.ro/web_gear/chat/editprofile2_6874.php",t=$("#meFormLogin"),o=$("#loginErr");t.off("submit").submit((function(t){t.preventDefault();let n={},a=$("#meUsername").val(),r=$("#mePassword").val();o.addClass("d-none"),n.email=filter(a),n.password=filter(r),n.SubmitPass=1,xConfig.me={},xConfig.me.username=a,xConfig.me.password=r,$(document.body).css({cursor:"wait"}),urlPost(e,filter(n)).then((function(t){if($(document.body).css({cursor:"default"}),t.Err.back){let o=t.Err.media.split(";="),n=$("#meback"),a=$("#summernote"),r=$("#summernote2"),i=$("#TabsSubmit");$("#melogin").addClass("d-none"),$("#meedit").removeClass("d-none"),$("#mainNav").addClass("d-none"),$("#secondNav").addClass("d-none"),0===pickersList.length&&initColorsPickers(),n&&n.val(t.Err.back),a&&o[0]&&a.summernote("code",o[0]),r&&o[1]&&r.summernote("code",o[1]),i.off("click").on("click",(()=>{$(document.body).css({cursor:"default"});let t={},o=n.val(),i=r.summernote("code"),s=a.summernote("code");o&&-1==o.indexOf("{")&&(o=filter(o)),t.username=xConfig.me.username||"",t.password=xConfig.me.password||"",t.back=o,t.media0=filter(i),t.media1=filter(s),t.submit1=1,urlPost(e,filter(t)).then((function(e){console.info(e)}))}))}else doErrorMsg(o,t.Err.editprofile2)}))}))}function DoTask2(e){switch(e){case"meedit":DoEditFirst();break;default:e="meedit",DoEditFirst()}page=e,$(".NavTabs").removeClass("active"),$("#tab"+e).addClass("active")}function DoEditFirst(){Reset(),$("#meedit").removeClass("d-none");$("#meback")}function initColorsPickers(){let e={theme:"nano",useAsButton:!0,closeOnScroll:!0,swatches:null,lockOpacity:!0,components:{palette:!0,preview:!0,opacity:!0,hue:!0,interaction:{save:!0,input:!0}}};for(let t=0;t<=4;t++)if(e.el="#button"+t,$("#button"+t).length){pickersList[t]=Pickr.create(e),pickersList[t].id="button"+t;let o=getIDFromButton(pickersList[t].id);if(o){let e=$("#"+o);if(e){let t=e.val();if("#"==t.charAt(0)&&7==t.length){let o=isColorLight(t);e.css({"background-color":t,color:o?"#000":"#FFF"})}e.off("keyup").on("keyup",(function(){let t=$(this).val();if("#"!==t.charAt(0)||"#"==t.charAt(0)&&7!==t.length)e.css({"background-color":"",color:"#001"});else{let o=isColorLight(t);e.css({"background-color":t,color:o?"#000":"#FFF"})}}))}}pickersList[t].on("save",((e,t)=>{if(o){let t=$("#"+o),n=e.toHEXA().toString(),a=isColorLight(n);t.css({"background-color":n,color:a?"#000":"#FFF"}),t.val(n)}})),pickersList[t].on("show",((e,n)=>{if(o){let e=$("#"+o);if(e.prop("disabled"))return void pickersList[t].hide();pickersList[t].setColor(e.val())}}))}}function getIDFromButton(e){if(!e)return!1;switch(e){case"button0":return"meback"}}function isColorLight(e){var t,o,n;return!!e&&(e.match(/^rgb/)?(t=(e=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/))[1],o=e[2],n=e[3]):(t=(e=+("0x"+e.slice(1).replace(5>e.length&&/./g,"$&$&")))>>16,o=255&e>>8,n=255&e),127.5<Math.sqrt(t*t*.299+o*o*.587+n*n*.114))}function initStuff(){$("a.btn").on("click",(function(e){e.preventDefault()})),document.querySelectorAll(".PassReveal").forEach((e=>{e.addEventListener("click",(e=>{PassReveal($(e.target))}))})),handlePopover()}$("#CommonDiv").html(""),GET.hash&&0==GET.params.length&&(location.hash="#"+GET.hash),$("#tabmeshow,#tabmelogin").click((function(e){let t=e.currentTarget.id.substr(3);return DoTask(t),location.hash="#!"+doRealHash(location.hash,t),!1})),DoTask(getRealHash()),$("#tabmeedit").click((function(e){let t=e.currentTarget.id.substr(3);return DoTask2(t),location.hash="#!"+doRealHash(location.hash,t),!1}));var didQuery=!1;function handlePopover(){if($('[data-toggle="popover"]').popover({trigger:"focus",html:!0}),!didQuery){let t=document.querySelectorAll('[data-toggle="popover"]');if(t.length>0){var e=[];t.forEach((function(t){e.push(setTranslateDiv(t,"popover"))})),e.length>0&&"en"!==xConfig.lang&&(localize(["chats"]),updateNodeTranslate(e))}didQuery=!0}}function initToolTip(e){var t=[];if(e)e.tooltip(),t.push(setTranslateDiv(e[0]||e,"tooltips"));else{$('[data-toggle="tooltip"]').tooltip({trigger:"hover"});let e=document.querySelectorAll('[data-toggle="tooltip"]');e.length>0&&e.forEach((function(e){t.push(setTranslateDiv(e,"tooltips"))}))}t.length>0&&"en"!==xConfig.lang&&(localize(["chats"]),updateNodeTranslate(t))}function setTranslateDiv(e,t){let o,n,a=e.dataset;if(a&&!e.contains(document.getElementById(t))){let r=document.createElement("div");return e.appendChild(r),a.content&&(o=createElement(r,"div","content"),o.innerHTML=a.content),a.originalTitle&&(n=createElement(r,"div","originalTitle"),n.innerHTML=a.originalTitle),r.id=t,r.className="d-none",[e,o,n]}}function updateNodeTranslate(e){if(!e)return!1;for(let t in e)e[t][1]&&e[t][0].setAttribute("data-content",e[t][1].innerHTML),e[t][2]&&e[t][0].setAttribute("data-original-title",e[t][2].innerHTML)}function SafeImage(e){if(0==e.length)return"";var t=parse_url(e);return(t||(t=parse_url(e="/"==e.charAt(0)?"https:"+e:"https://"+e)))&&t.host?0<=t.host.indexOf("rxat.ro")&&0<t.path.indexOf("GetImage")?e:"/web_gear/chat/GetImage7.php?U="+e:""}function parse_url(e,t){for(var o=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],n={},a=n["phpjs.parse_url.mode"]&&n["phpjs.parse_url.mode"].local_value||"php",r={php:/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/\/?)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},i=r[a].exec(e),s={},l=14;l--;)i[l]&&(s[o[l]]=i[l]);if(t)return s[t.replace("PHP_URL_","").toLowerCase()];if("php"!==a){var c=n["phpjs.parse_url.queryKey"]&&n["phpjs.parse_url.queryKey"].local_value||"queryKey";r=/(?:^|&)([^&=]*)=?([^&]*)/g,s[c]={},(s[o[12]]||"").replace(r,(function(e,t,o){t&&(s[c][t]=o)}))}return delete s.source,s}$("#summernote").summernote({height:200,minHeight:100,maxHeight:700,disableDragAndDrop:!0,toolbar:[["font",["bold","underline","italic","clear"]],["fontname",["fontname","fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["insert",["link"]]],callbacks:{onImageLinkInsert:function(e){if(!e.length)return;let t=SafeImage(e);$(this).summernote("insertImage",t)}}}),$("#summernote2").summernote({height:200,minHeight:100,maxHeight:700,disableDragAndDrop:!0,toolbar:[["font",["bold","underline","italic","clear"]],["fontname",["fontname","fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["insert",["link","picture"]],["view",["codeview"]]],callbacks:{onImageLinkInsert:function(e){if(!e.length)return;let t=SafeImage(e);$(this).summernote("insertImage",t)}}});var imageUploadDiv=$("div.note-group-select-from-files");imageUploadDiv.length&&imageUploadDiv.remove(),$(".note-color button.dropdown-toggle").html('<i class="note-icon-caret"></i>'),$(".noread").attr("readonly",!0),$(".noread").css("background-color","white"),$(".noread").click((function(){$(".noread").attr("readonly",!1)})),$("#meLogo").hover((function(){$(".navMe").fadeIn()})),$(".navMe").hover((function(){$(this).addClass("show")}),(function(){$(this).removeClass("show").fadeOut()}));
