"use strict";function _inheritsLoose(a,b){a.prototype=Object.create(b.prototype);a.prototype.constructor=a;a.__proto__=b}var Menu=function(a){_inheritsLoose(b,a);function b(){var b;b=a.call(this,{key:"Menu"})||this;b.info=null;b.player=null;b.opponent=null;b.BootEvents=null;b.soloButton=null;b.quitMessage=null;b.firstButton=null;return b}var c=b.prototype;c.init=function init(a){this.playing=!1;this.gameOver=!1;this.opponent=null;this.player=a.player;this.quitMessage=a.quit;this.events.on("quit",this.onUserQuit,this);this.events.on("doReset",this.doReset,this);this.events.on("onUserOk",this.onUserOk,this);this.events.on("onTabChanged",this.onTabChanged,this);this.BootEvents=this.scene.get("Boot").events;this.BkgEvents=this.scene.get("Background").events;this.BootEvents.emit("setReady",!0);this.BootEvents.emit("send",2,0,0)};c.create=function create(){var a=this;this.BkgEvents.emit("change",1);var b=new Button(this,15,15,"helpButton",function(){window.open("https://util.rxat.ro/wiki/index.php?title=Four_in_a_row","_blank")}).setOrigin(0);var c=new Button(this,this.cameras.main.width-15,15,"statsButton",function(){a.SendGame({from:a.player,to:a.opponent,type:"quit",user:a.player});a.BootEvents.emit("setReady",!1);a.BootEvents.emit("doReset");a.scene.start("Stats")}).setOrigin(1,0);this.info=this.add.dynamicBitmapText(this.cameras.main.centerX,this.cameras.main.centerY+200,"roboto","Connecting...",24).setOrigin(.5);var d=null;if(this.quitMessage){d=this.add.dynamicBitmapText(this.cameras.main.centerX,this.cameras.main.centerY+265,"roboto","Your opponent left the game.",24).setOrigin(.5).setAlpha(.6);this.tweens.add({targets:d,alpha:0,delay:500,duration:1e3,ease:"Back.easeInOut",onComplete:function onComplete(){d.destroy()}})}};c.onUserOk=function onUserOk(a){if(this.opponent!=a){if(0!=a){this.opponent=a}else{this.opponent=null}}this.onTabChanged(a)};c.doReset=function doReset(){this.opponent=null};c.onUserQuit=function onUserQuit(a,b){if(this.opponent==a){this.opponent=null;if(b){var c=null;c=this.add.dynamicBitmapText(this.cameras.main.centerX,this.cameras.main.centerY+265,"roboto","Your opponent left the game.",24).setOrigin(.5).setAlpha(.6);this.tweens.add({targets:c,alpha:0,delay:700,duration:1300,ease:"Back.easeInOut",onComplete:function onComplete(){c.destroy()}})}this.onTabChanged(a)}};c.onTabChanged=function onTabChanged(a){var b=this;if(!this.cameras.main)return;if(!a){this.BootEvents.emit("setReady",!1);if(this.soloButton)this.soloButton.destroy();if(this.firstButton)this.firstButton.destroy();this.soloButton=new Button(this,this.cameras.main.centerX,this.cameras.main.centerY+200,"soloButton",function(){b.BootEvents.emit("setPlaying");b.BootEvents.emit("setReady",!1);b.scene.start("Solo",b.player)});this.info.setText("Private chat a person to play").setY(this.cameras.main.centerY+140)}else if(this.opponent!=a){this.BootEvents.emit("setReady",!0);if(this.soloButton)this.soloButton.destroy();if(this.firstButton)this.firstButton.destroy();this.info.setText("Waiting for other player...").setY(this.cameras.main.centerY+200)}else{if(this.soloButton)this.soloButton.destroy();if(this.firstButton)this.firstButton.destroy();this.firstButton=new Button(this,this.cameras.main.centerX,this.cameras.main.centerY+200,"firstButton",function(){b.BootEvents.emit("setPlaying");b.BootEvents.emit("setReady",!1);b.SendGame({type:"start",turn:b.player,scene:"Menu"});b.scene.start("Main",{player:b.player,opponent:b.opponent,turn:b.player})});this.info.setText("Make the first move?").setY(this.cameras.main.centerY+140)}};c.SendGame=function SendGame(a){a.to=this.opponent;a.from=this.player;this.BootEvents.emit("sendGame",a)};return b}(Phaser.Scene);
